# Description:
#  Main application source code.
#  HTML and assets live under //app/.

package(default_visibility = ["//:internal"])

load("//builddefs:config.bzl", "COMMON_JS_SUPPRESSIONS")
load("//builddefs:less_rules.bzl", "less_css_library")
load("@io_bazel_rules_closure//closure:defs.bzl", "closure_js_library")
load("@io_bazel_rules_closure//closure:defs.bzl", "closure_js_template_library")

closure_js_library(
    name = "app",
    srcs = [
        "addonmanager.js",
        "app.js",
        "documentview.js",
        "exports.js",
        "framepainter.js",
        "granularity.js",
        "graphics/canvaspanel.js",
        "healthdialog.js",
        "helpdialog.js",
        "loader.js",
        "maindisplay.js",
        "markpainter.js",
        "nav/heatmappainter.js",
        "nav/navbar.js",
        "nav/statsbox.js",
        "nav/timelinepainter.js",
        "query/querypanel.js",
        "query/querytablesource.js",
        "selection.js",
        "selectionpainter.js",
        "splashdialog.js",
        "statusbar.js",
        "tabbar.js",
        "tabpanel.js",
        "toolbar.js",
        "tracks/statisticstablesource.js",
        "tracks/timerangepainter.js",
        "tracks/trackinfobar.js",
        "tracks/trackspanel.js",
        "tracks/zonepainter.js",
    ],
    suppress = COMMON_JS_SUPPRESSIONS,
    deps = [
        ":app_templates",
        "//src/wtf",
        "//src/wtf/addon",
        "//src/wtf/data",
        "//src/wtf/db",
        "//src/wtf/db:unit",
        "//src/wtf/doc",
        "//src/wtf/events",
        "//src/wtf/events:eventemitter",
        "//src/wtf/io",
        "//src/wtf/io/cff",
        "//src/wtf/ipc",
        "//src/wtf/math",
        "//src/wtf/pal",
        "//src/wtf/replay/graphics",
        "//src/wtf/replay/graphics/ui",
        "//src/wtf/replay/timetravel",
        "//src/wtf/timing",
        "//src/wtf/ui:color",
        "//src/wtf/ui:control",
        "//src/wtf/ui:dialog",
        "//src/wtf/ui:errordialog",
        "//src/wtf/ui:gridpainter",
        "//src/wtf/ui:progressdialog",
        "//src/wtf/ui:rangepainter",
        "//src/wtf/ui:rulerpainter",
        "//src/wtf/ui:searchcontrol",
        "//src/wtf/ui:settingsdialog",
        "//src/wtf/ui:timepainter",
        "//src/wtf/ui:tooltip",
        "//src/wtf/ui:virtualtable",
        "//src/wtf/ui:zoom",
        "//src/wtf/util",
        "@io_bazel_rules_closure//closure/library",
    ],
)

closure_js_template_library(
    name = "app_templates",
    srcs = [
        "documentview.soy",
        "graphics/canvaspanel.soy",
        "healthdialog.soy",
        "helpdialog.soy",
        "maindisplay.soy",
        "nav/navbar.soy",
        "nav/statsbox.soy",
        "query/querypanel.soy",
        "splashdialog.soy",
        "statusbar.soy",
        "tabbar.soy",
        "toolbar.soy",
        "tracks/trackinfobar.soy",
        "tracks/trackspanel.soy",
    ],
)

less_css_library(
    name = "app_styles",
    srcs = [
        "documentview.less",
        "graphics/canvaspanel.less",
        "graphics/graphics.less",
        "healthdialog.less",
        "helpdialog.less",
        "maindisplay.less",
        "nav/nav.less",
        "nav/navbar.less",
        "nav/statsbox.less",
        "query/query.less",
        "query/querypanel.less",
        "splashdialog.less",
        "statusbar.less",
        "tabbar.less",
        "toolbar.less",
        "tracks/trackinfobar.less",
        "tracks/tracks.less",
        "tracks/trackspanel.less",
    ],
    includes = ["src"],
    main_srcs = ["app.less"],
    deps = [
        "//src/wtf/replay/graphics/ui:graphics_styles",
        "//src/wtf/replay/timetravel:timetravel_styles",
        "//src/wtf/ui:ui_styles",
        "//src/wtf/ui/styles",
    ],
)
